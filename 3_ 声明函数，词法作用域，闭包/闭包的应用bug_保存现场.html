<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>闭包的应用bug_保存现场</title>
</head>
<body>
<p>第一行</p>
<p>第二行</p>
<p>第三行</p>


<script type="text/javascript" charset="UTF-8">
	//function addhandler(nodes){
		// for(var i=0;i<nodes.length;i++){
		// 	var node=nodes[i];
		// 	node.onclick=function(){  此匿名函数没有被调用，所以他并没有保存当时的值
		// 		alert(i);
		// 	}
		// }
	//}
	
	
	//解决方案一
//	function addHandler(nodes){
//		//使用一个嵌套函数来解决
//		function invoke(i){
//			return function(){ //闭包
//				alert (i+1);
//			}
//		}
//		for(var i=0;i<nodes.length;i++){
//			var node=nodes[i];
//			node.onclick=invoke(i);
//		}
//	}

	
	function addHandler(nodes){
//		//使用一个嵌套函数来解决
		for(var i=0;i<nodes.length;i++){
			var node=nodes[i];
			node.onclick=function (i){
				return function(){ //闭包
					alert (i+1);
				}
			}(i);
		}
	}
	
	var nodes=document.getElementsByTagName("p");
	addHandler(nodes);
</script>	
</body>
</html>